name = "Auth with headers"
description = "Allow or deny a request based on a known pre-shared key in a header."
code = """
async function handleRequest(request) {
  let psk = request.headers.get(presharedAuthHeaderKey)
  if (psk === presharedAuthHeaderValue) {
    // Correct preshared header key supplied. Fetching request
    return fetch(request)
  } else {
    // Incorrect preshared header key supplied. Rejecting request
    return new Response('Sorry, you have supplied an invalid key.', {
      status: 403
    })
  }
}
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})
/**
 * Replace these values with your preshared auth header key and value
 * @param {string} presharedAuthHeaderKey
 * @param {string} presharedAuthHeaderValue
 */
const presharedAuthHeaderKey = 'X-Custom-PSK'
const presharedAuthHeaderValue = 'mypresharedkey'"""
demo_url = "https://cloudflareworkers.com/#6d603c1b80718d6799258e703f35a032:https://tutorial.cloudflareworkers.com/"
