name = "Auth with headers"
description = "Allow or deny a request based on authentication headers"
code = """async function handleRequest(request) {
  return handleAuth(request)
}
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})
/**
 * Processes your request if auth headers are right
 * @param {Request} request
 */
function handleAuth(request) {
  let psk = request.headers.get(presharedAuthHeaderKey)

  if (psk === presharedAuthHeaderValue) {
    // Correct preshared header key supplied. Fetching request
    return fetch(request)
  } else {
    // Incorrect preshared header key supplied. Rejecting request
    return new Response('Sorry, you have supplied an invalid key.', {
      status: 403,
      statusText: 'Forbidden',
    })
  }
}
/**
 * Replace these values with your preshared auth header key and value
 * @param {string} presharedAuthHeaderKey
 * @param {string} presharedAuthHeaderValue
 */
const presharedAuthHeaderKey = 'X-Custom-PSK'
const presharedAuthHeaderValue = 'mypresharedkey'"""
demo_url = "https://cloudflareworkers.com/#a0492bd3302463e0fa98ff58d1dfed20:https://tutorial.cloudflareworkers.com/"
