name = "Conditional Response"
description = "Return a response based on the incoming request's URL, HTTP method, User Agent, IP address, ASN or device type (e.g. mobile)"
code = """const BLOCKED_HOSTNAMES = ['nope.mywebsite.com', 'bye.website.com']
async function handleRequest(request) {
  // On URL's hostname
  let url = new URL(request.url)
  if (BLOCKED_HOSTNAMES.includes(url.hostname)) {
    return new Response('Blocked Host', { status: 403 })
  }
  // On URL's file extenstion (e.g. block paths ending in .doc or .xml)
  let forbiddenExtRegExp = new RegExp(/\\.(doc|xml)$/)
  if (forbiddenExtRegExp.test(url.pathname)) {
    return new Response('Blocked Extension', { status: 403 })
  }
  // On HTTP method
  if (request.method === 'POST') {
    return new Response('Response for POST')
  }
  // On User Agent
  let userAgent = request.headers.get('User-Agent') || ''
  if (userAgent.includes('bot')) {
    return new Response('BOT User Agent response', { status: 403 })
  }
  // On Client's IP address
  let clientIP = request.headers.get('CF-Connecting-IP')
  if (clientIP === '2606:4700:ff02:8250:5c23:f51b:a5ff:67b1') {
    return new Response('Response for IP')
  }
  // On ASN
  if ((request.cf || {}).asn == 64512) {
    return new Response('ASN response')
  }
  // On Device Type
  //  Requires Enterprise "CF-Device-Type Header" zone setting or
  //  Page Rule with "Cache By Device Type" setting applied.
  let device = request.headers.get('CF-Device-Type')
  if (device === 'mobile') {
    return Response.redirect('https://mobile.example.com')
  }
  console.error(
    "Getting Client's IP address, device type, and ASN are not supported in playground. Must test on a live worker",
  )
  return fetch(request)
}
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})
"""
demo_url="https://cloudflareworkers.com/#c5c6e6156a4cb662cc19468f1f9f95bf:https://nope.mywebsite.com/"